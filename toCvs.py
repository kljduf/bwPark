from datetime import datetime
import pandas as pd

# 输入内容（你可以替换成读取文件的内容）
content = """
2025-07-11 周五
活动代码：913  恋与深空无料活动预约 预约：2025-07-05 13:10:00 开始：2025-07-11 09:00:00
活动代码：916  恋与深空-沈星回誓约心迹 预约：2025-07-06 12:00:00 开始：2025-07-11 09:30:00
活动代码：919  恋与深空-黎深誓约心迹 预约：2025-07-06 12:00:00 开始：2025-07-11 09:30:00
活动代码：922  恋与深空-祁煜誓约心迹 预约：2025-07-06 12:00:00 开始：2025-07-11 09:30:00
活动代码：925  恋与深空-秦彻誓约心迹 预约：2025-07-06 12:00:00 开始：2025-07-11 09:30:00
活动代码：928  恋与深空-夏以昼誓约心迹 预约：2025-07-06 12:00:00 开始：2025-07-11 09:30:00
活动代码：789  猫耳FM广播剧《FOG[电竞]》声优见面会&签名会 预约：2025-07-05 12:15:00 开始：2025-07-11 10:30:00
活动代码：790  猫耳FM广播剧《台风眼》声优见面会&签名会 预约：2025-07-05 12:15:00 开始：2025-07-11 12:30:00
活动代码：791  音熊联萌周年见面会 预约：2025-07-05 12:15:00 开始：2025-07-11 14:30:00
活动代码：797  《无限暖暖》展台AR合影【10:00场】 预约：2025-07-06 12:30:00 开始：2025-07-11 10:00:00
活动代码：798  《无限暖暖》展台AR合影【11:30场】 预约：2025-07-06 12:30:00 开始：2025-07-11 11:30:00
活动代码：799  《无限暖暖》展台AR合影【13:30场】 预约：2025-07-06 12:30:00 开始：2025-07-11 13:30:00
活动代码：806  《无限暖暖》展台搭配赛【11:00场】 预约：2025-07-06 12:35:00 开始：2025-07-11 11:00:00
活动代码：807  《无限暖暖》展台搭配赛【12:00场】 预约：2025-07-06 12:35:00 开始：2025-07-11 12:00:00
活动代码：808  《无限暖暖》展台搭配赛【13:00场】 预约：2025-07-06 12:35:00 开始：2025-07-11 13:00:00
活动代码：815  《无限暖暖》展台幻境试炼【10:00场】 预约：2025-07-06 12:40:00 开始：2025-07-11 10:00:00
活动代码：816  《无限暖暖》展台幻境试炼【14:00场】 预约：2025-07-06 12:40:00 开始：2025-07-11 14:00:00
活动代码：817  《无限暖暖》展台幻境试炼【15:00场】 预约：2025-07-06 12:40:00 开始：2025-07-11 15:00:00
活动代码：824  三宋在这见面会&签名会 预约：2025-07-05 12:30:00 开始：2025-07-11 11:00:00
活动代码：825  俞涛不光会做九转大肠见面会&签名会 预约：2025-07-05 12:30:00 开始：2025-07-11 12:45:00
活动代码：826  Meetfood觅食见面会&签名会 预约：2025-07-05 12:30:00 开始：2025-07-11 14:30:00
活动代码：827  汤木檀泽见面会&签名会 预约：2025-07-05 12:30:00 开始：2025-07-11 11:00:00
活动代码：828  宋浩老师官方见面会&签名会 预约：2025-07-05 12:30:00 开始：2025-07-11 12:45:00
活动代码：829  大物是也特典会 预约：2025-07-05 12:30:00 开始：2025-07-11 14:30:00
活动代码：842  咕gugugugu签售会 预约：2025-07-05 12:35:00 开始：2025-07-11 11:00:00
活动代码：843  因你而在的梦签售会 预约：2025-07-05 12:35:00 开始：2025-07-11 12:45:00
活动代码：844  兔总裁s签售会 预约：2025-07-05 12:35:00 开始：2025-07-11 14:30:00
活动代码：845  樱萍Apple签售会 预约：2025-07-05 12:35:00 开始：2025-07-11 11:00:00
活动代码：846  Tocci椭奇签售会 预约：2025-07-05 12:35:00 开始：2025-07-11 12:45:00
活动代码：847  -FIVEver-签售会 预约：2025-07-05 12:35:00 开始：2025-07-11 14:30:00
活动代码：848  扭蛋姬乐队签售会 预约：2025-07-05 12:35:00 开始：2025-07-11 12:45:00
活动代码：849  矮乐多Aliga签售会 预约：2025-07-05 12:35:00 开始：2025-07-11 14:30:00
活动代码：869  HxxG签名会 预约：2025-07-06 12:50:00 开始：2025-07-11 15:00:00
活动代码：870  Kieed签名会 预约：2025-07-06 12:50:00 开始：2025-07-11 14:00:00
活动代码：871  モ誰_MODARE签名会 预约：2025-07-06 12:50:00 开始：2025-07-11 15:00:00
活动代码：878  蔚蓝档案舞台互动 预约：2025-07-05 13:00:00 开始：2025-07-11 12:00:00
活动代码：881  RTX 5080公版显卡限量发售【11:00场】 预约：2025-07-05 13:05:00 开始：2025-07-11 11:00:00
活动代码：882  RTX 5070公版显卡限量发售【11:00场】 预约：2025-07-05 13:05:00 开始：2025-07-11 11:00:00
活动代码：883  RTX 5080公版显卡限量发售【14:00场】 预约：2025-07-05 13:05:00 开始：2025-07-11 14:00:00
活动代码：884  RTX 5070公版显卡限量发售【14:00场】 预约：2025-07-05 13:05:00 开始：2025-07-11 14:00:00

2025-07-12 周六 
活动代码：914  恋与深空无料活动预约 预约：2025-07-05 13:15:00 开始：2025-07-12 09:00:00
活动代码：917  恋与深空-沈星回誓约心迹 预约：2025-07-06 12:05:00 开始：2025-07-12 09:30:00
活动代码：920  恋与深空-黎深誓约心迹 预约：2025-07-06 12:05:00 开始：2025-07-12 09:30:00
活动代码：923  恋与深空-祁煜誓约心迹 预约：2025-07-06 12:05:00 开始：2025-07-12 09:30:00
活动代码：926  恋与深空-秦彻誓约心迹 预约：2025-07-06 12:05:00 开始：2025-07-12 09:30:00
活动代码：929  恋与深空-夏以昼誓约心迹 预约：2025-07-06 12:05:00 开始：2025-07-12 09:30:00
活动代码：792  猫耳FM广播剧《陈年烈苟》声优见面会&签名会 预约：2025-07-05 12:20:00 开始：2025-07-12 10:30:00
活动代码：912  猫耳FM2025织音发布会 预约：2025-07-05 12:20:00 开始：2025-07-12 12:30:00
活动代码：793  LASER&MANTA2025周年庆典直播 预约：2025-07-05 12:20:00 开始：2025-07-12 14:00:00
活动代码：800  《无限暖暖》展台AR合影【10:00场】 预约：2025-07-06 12:30:00 开始：2025-07-12 10:00:00
活动代码：801  《无限暖暖》展台AR合影【11:30场】 预约：2025-07-06 12:30:00 开始：2025-07-12 11:30:00
活动代码：802  《无限暖暖》展台AR合影【13:30场】 预约：2025-07-06 12:30:00 开始：2025-07-12 13:30:00
活动代码：809  《无限暖暖》展台搭配赛【11:00场】 预约：2025-07-06 12:35:00 开始：2025-07-12 11:00:00
活动代码：810  《无限暖暖》展台搭配赛【12:00场】 预约：2025-07-06 12:35:00 开始：2025-07-12 12:00:00
活动代码：811  《无限暖暖》展台搭配赛【13:00场】 预约：2025-07-06 12:35:00 开始：2025-07-12 13:00:00
活动代码：818  《无限暖暖》展台幻境试炼【10:00场】 预约：2025-07-06 12:40:00 开始：2025-07-12 10:00:00
活动代码：819  《无限暖暖》展台幻境试炼【14:00场】 预约：2025-07-06 12:40:00 开始：2025-07-12 14:00:00
活动代码：820  《无限暖暖》展台幻境试炼【15:00场】 预约：2025-07-06 12:40:00 开始：2025-07-12 15:00:00
活动代码：830  咪克菌见面会&签名会 预约：2025-07-05 12:40:00 开始：2025-07-12 11:00:00
活动代码：831  理查不会降落见面会&签名会 预约：2025-07-05 12:40:00 开始：2025-07-12 12:45:00
活动代码：832  -欣小萌-&伤心欲茄222见面会&签名会 预约：2025-07-05 12:40:00 开始：2025-07-12 14:30:00
活动代码：833  黄正义_见面会&签名会 预约：2025-07-05 12:40:00 开始：2025-07-12 11:00:00
活动代码：834  是一只九龄见面会&签名会 预约：2025-07-05 12:40:00 开始：2025-07-12 12:45:00
活动代码：835  取景框看世界见面会&签名会 预约：2025-07-05 12:40:00 开始：2025-07-12 14:30:00
活动代码：850  余多多Dudu签售会 预约：2025-07-05 12:45:00 开始：2025-07-12 11:30:00
活动代码：851  土屋安娜签售会 预约：2025-07-05 12:45:00 开始：2025-07-12 14:30:00
活动代码：852  K小K嗷签售会 预约：2025-07-05 12:45:00 开始：2025-07-12 11:00:00
活动代码：853  咝小喵MAO签售会 预约：2025-07-05 12:45:00 开始：2025-07-12 12:45:00
活动代码：854  小花罗梦签售会 预约：2025-07-05 12:45:00 开始：2025-07-12 15:00:00
活动代码：855  一只大王哀签售会 预约：2025-07-05 12:45:00 开始：2025-07-12 11:30:00
活动代码：856  莓可-w-签售会 预约：2025-07-05 12:45:00 开始：2025-07-12 13:15:00
活动代码：857  李兰陵签售会 预约：2025-07-05 12:45:00 开始：2025-07-12 15:00:00
活动代码：867  B漫《孤独摇滚！》BW漫画签售会 预约：2025-07-06 12:45:00 开始：2025-07-12 10:00:00
活动代码：868  B漫《孤独摇滚！》BW漫画签售会 预约：2025-07-06 12:45:00 开始：2025-07-12 12:30:00
活动代码：872  ろるあ_Rolua签名会 预约：2025-07-06 12:55:00 开始：2025-07-12 15:00:00
活动代码：873  抹茶專門店AM签名会 预约：2025-07-06 12:55:00 开始：2025-07-12 15:00:00
活动代码：874  STAR影法师签名会 预约：2025-07-06 12:55:00 开始：2025-07-12 15:00:00
活动代码：879  蔚蓝档案舞台互动 预约：2025-07-05 13:00:00 开始：2025-07-12 12:00:00
活动代码：885  RTX 5080公版显卡限量发售【11:00场】 预约：2025-07-05 13:05:00 开始：2025-07-12 11:00:00
活动代码：886  RTX 5070公版显卡限量发售【11:00场】 预约：2025-07-05 13:05:00 开始：2025-07-12 11:00:00
活动代码：887  RTX 5080公版显卡限量发售【14:00场】 预约：2025-07-05 13:05:00 开始：2025-07-12 14:00:00
活动代码：888  RTX 5070公版显卡限量发售【14:00场】 预约：2025-07-05 13:05:00 开始：2025-07-12 14:00:00

2025-07-13 周日
活动代码：915  恋与深空无料活动预约 预约：2025-07-05 13:20:00 开始：2025-07-13 09:00:00
活动代码：918  恋与深空-沈星回誓约心迹 预约：2025-07-06 12:10:00 开始：2025-07-13 09:30:00
活动代码：921  恋与深空-黎深誓约心迹 预约：2025-07-06 12:10:00 开始：2025-07-13 09:30:00
活动代码：924  恋与深空-祁煜誓约心迹 预约：2025-07-06 12:10:00 开始：2025-07-13 09:30:00
活动代码：927  恋与深空-秦彻誓约心迹 预约：2025-07-06 12:10:00 开始：2025-07-13 09:30:00
活动代码：930  恋与深空-夏以昼誓约心迹 预约：2025-07-06 12:10:00 开始：2025-07-13 09:30:00
活动代码：794  猫耳FM广播剧《我在无限游戏里封神》声优见面会&签名会 预约：2025-07-05 12:25:00 开始：2025-07-13 10:30:00
活动代码：795  猫耳FM广播剧《奇洛李维斯回信》声优见面会&签名会 预约：2025-07-05 12:25:00 开始：2025-07-13 12:30:00
活动代码：796  无限暖暖【美好无限，牵手同游】特别互动 预约：2025-07-05 12:25:00 开始：2025-07-13 14:30:00
活动代码：803  《无限暖暖》展台AR合影【10:00场】 预约：2025-07-06 12:30:00 开始：2025-07-13 10:00:00
活动代码：804  《无限暖暖》展台AR合影【11:30场】 预约：2025-07-06 12:30:00 开始：2025-07-13 11:30:00
活动代码：805  《无限暖暖》展台AR合影【13:30场】 预约：2025-07-06 12:30:00 开始：2025-07-13 13:30:00
活动代码：812  《无限暖暖》展台搭配赛【11:00场】 预约：2025-07-06 12:35:00 开始：2025-07-13 11:00:00
活动代码：813  《无限暖暖》展台搭配赛【12:00场】 预约：2025-07-06 12:35:00 开始：2025-07-13 12:00:00
活动代码：814  《无限暖暖》展台搭配赛【13:00场】 预约：2025-07-06 12:35:00 开始：2025-07-13 13:00:00
活动代码：821  《无限暖暖》展台幻境试炼【10:00场】 预约：2025-07-06 12:40:00 开始：2025-07-13 10:00:00
活动代码：822  《无限暖暖》展台幻境试炼【14:00场】 预约：2025-07-06 12:40:00 开始：2025-07-13 14:00:00
活动代码：823  《无限暖暖》展台幻境试炼【15:00场】 预约：2025-07-06 12:40:00 开始：2025-07-13 15:00:00
活动代码：836  特厨隋坡见面会&签名会 预约：2025-07-05 12:50:00 开始：2025-07-13 11:00:00
活动代码：837  姜阿四见面会&签名会 预约：2025-07-05 12:50:00 开始：2025-07-13 12:45:00
活动代码：838  雨琪在芬兰见面会&签名会 预约：2025-07-05 12:50:00 开始：2025-07-13 14:30:00
活动代码：839  佳茗见面会&签名会 预约：2025-07-05 12:50:00 开始：2025-07-13 11:00:00
活动代码：840  山新&罗小黑战记见面会&签名会 预约：2025-07-05 12:50:00 开始：2025-07-13 12:45:00
活动代码：841  米饭仙人&山下智博见面会&签名会 预约：2025-07-05 12:50:00 开始：2025-07-13 14:30:00
活动代码：858  蝴蜜·humi签售会 预约：2025-07-05 12:55:00 开始：2025-07-13 11:00:00
活动代码：859  i-Link签售会 预约：2025-07-05 12:55:00 开始：2025-07-13 12:45:00
活动代码：860  犬舍乐队签售会 预约：2025-07-05 12:55:00 开始：2025-07-13 14:30:00
活动代码：861  LonePi、szri、SEE签售会 预约：2025-07-05 12:55:00 开始：2025-07-13 11:00:00
活动代码：862  伢伢gagako签售会 预约：2025-07-05 12:55:00 开始：2025-07-13 12:45:00
活动代码：863  -欣小萌-签售会 预约：2025-07-05 12:55:00 开始：2025-07-13 14:30:00
活动代码：864  绫濑双双签售会 预约：2025-07-05 12:55:00 开始：2025-07-13 11:00:00
活动代码：865  豆豆子ex签售会 预约：2025-07-05 12:55:00 开始：2025-07-13 12:45:00
活动代码：866  泡芙喵-PuFF签售会 预约：2025-07-05 12:55:00 开始：2025-07-13 14:30:00
活动代码：875  QuAn___ 签名会 预约：2025-07-06 13:00:00 开始：2025-07-13 14:00:00
活动代码：876  旋风博文签名会 预约：2025-07-06 13:00:00 开始：2025-07-13 14:00:00
活动代码：877  屉子巴德签名会 预约：2025-07-06 13:00:00 开始：2025-07-13 14:00:00
活动代码：880  蔚蓝档案舞台互动 预约：2025-07-05 13:00:00 开始：2025-07-13 12:00:00
活动代码：889  RTX 5080公版显卡限量发售【11:00场】 预约：2025-07-05 13:05:00 开始：2025-07-13 11:00:00
活动代码：890  RTX 5070公版显卡限量发售【11:00场】 预约：2025-07-05 13:05:00 开始：2025-07-13 11:00:00
活动代码：891  RTX 5080公版显卡限量发售【14:00场】 预约：2025-07-05 13:05:00 开始：2025-07-13 14:00:00
活动代码：892  RTX 5070公版显卡限量发售【14:00场】 预约：2025-07-05 13:05:00 开始：2025-07-13 14:00:00
...
"""

# 初始化变量
current_date_str = None
current_day = None
data = []

# 处理每一行
for line in content.strip().split('\n'):
    line = line.strip()

    # 判断是否是日期行
    if line.startswith("2025-"):
        date_part = line.split()[0]
        current_date_str = date_part
        current_date = datetime.strptime(current_date_str, "%Y-%m-%d")
        weekday = current_date.strftime("%A")

        if weekday == "Friday":
            current_day = "d1"
        elif weekday == "Saturday":
            current_day = "d2"
        elif weekday == "Sunday":
            current_day = "d3"
        else:
            current_day = ""

    # 判断是否是活动行
    elif line.startswith("活动代码："):
        parts = line.split("预约：")
        activity_info = parts[0].strip()
        reserve_time = parts[1].split("开始：")[0].strip()

        # 提取活动代码和名称
        act_code_part, name = activity_info.split("  ", 1)
        act_code = act_code_part.replace("活动代码：", "").strip()
        activity_name = name.strip()

        # 添加到数据列表
        data.append({
            "预约时间": reserve_time,
            "活动时间": current_day,
            "活动": activity_name,
            "活动代码": act_code
        })

# 创建 DataFrame 并保存为 CSV
df = pd.DataFrame(data)
df.to_csv("output_activities.csv", index=False, encoding="utf-8-sig")

print("表格已成功生成并保存为 output_activities.csv")